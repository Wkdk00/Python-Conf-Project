# Визуализатор графа зависимостей

---
## Этап 1

Минимальный CLI-прототип инструмента для анализа зависимостей пакетов.  
На данном этапе реализована только загрузка и валидация конфигурации.

## Требования

- Python 3.7+
- Библиотека `toml`

Установка зависимостей:
```bash
pip install toml
```

## Использование

1. Создайте конфигурационный файл в формате TOML (см. `config.toml.example`).
2. Запустите приложение, указав путь к файлу:

```bash
python main.py config.toml
```

Приложение выведет все настраиваемые параметры в формате `ключ = значение`.

## Настраиваемые параметры

- `package_name` — имя анализируемого пакета (строка)
- `repository_url` — URL репозитория или путь к локальному файлу (строка)
- `repo_mode` — режим работы: `local` или `remote` (строка)
- `package_version` — версия пакета (строка)
- `max_depth` — максимальная глубина анализа зависимостей (целое число ≥ 0)

Все параметры обязательны. При ошибках в конфигурации выводится понятное сообщение.

---

## Этап 2

Реализована логика получения **прямых зависимостей** указанного npm-пакета заданной версии **без использования менеджеров пакетов**.

### Особенности реализации:
- Поддерживается только режим `repo_mode = "remote"`.
- Запрос отправляется к публичному npm registry: `https://registry.npmjs.org/{package}/{version}`.
- Ответ парсится с помощью стандартной библиотеки (`json`, `urllib`).
- Извлекается поле `dependencies` из метаданных пакета.
- Все прямые зависимости выводятся в формате `имя@версия`.
- Реализована обработка ошибок:
  - HTTP-ошибки (404, 500 и т.д.)
  - Некорректный JSON
  - Проблемы с сетью
  - Неизвестные исключения

### Пример конфигурации (`conf.toml`):
```toml
package_name = "express"
repository_url = "https://registry.npmjs.org"
repo_mode = "remote"
package_version = "4.18.2"
max_depth = 3
```

### Запуск:
```bash
python main.py conf.toml
```

Пример вывода:
```
package_name = express
repository_url = https://registry.npmjs.org
repo_mode = remote
package_version = 4.18.2
max_depth = 3
Прямые зависимости:
accepts@~1.3.8
array-flatten@1.1.1
body-parser@2.0.1
...
```

Конечно! Вот готовый раздел **Этап 2** для вашего `README.md`, оформленный в стиле уже существующего текста:

---

## Этап 2

Реализована логика получения **прямых зависимостей** указанного npm-пакета заданной версии **без использования менеджеров пакетов**.

### Особенности реализации:
- Поддерживается только режим `repo_mode = "remote"`. При попытке использовать `local` выводится ошибка и программа завершается.
- Запрос отправляется к публичному npm registry по адресу:  
  `https://registry.npmjs.org/{package_name}/{package_version}`.
- Ответ парсится с использованием стандартных модулей Python (`urllib.request`, `json`).
- Из метаданных пакета извлекается поле `dependencies`.
- Все прямые зависимости выводятся в формате `имя@версия`.
- Реализована детальная обработка ошибок:
  - HTTP-ошибки (например, пакет или версия не найдены — 404)
  - Ошибки сети (недоступность реестра)
  - Некорректный JSON в ответе
  - Непредвиденные исключения

### Пример конфигурации (`config.toml`):
```toml
package_name = "express"
repository_url = "https://registry.npmjs.org"
repo_mode = "remote"
package_version = "4.18.2"
max_depth = 3
```

> **Примечание:** Поле `repository_url` в текущей реализации не используется для формирования URL-запроса, так как npm registry имеет фиксированный адрес. Однако оно сохранено для совместимости с общей структурой конфигурации и возможного расширения в будущих этапах.

### Запуск:
```bash
python main.py config.toml
```

### Пример вывода:
```
Прямые зависимости:
accepts@~1.3.8
depd@2.0.0
encodeurl@~1.0.2
escape-html@~1.0.3
etag@~1.8.1
```

Если у пакета нет прямых зависимостей, выводится сообщение:  
`Прямые зависимости отсутствуют.`

Все ошибки во время выполнения выводятся в `stderr`, и программа завершается с кодом `1`.

---

Вот краткие разделы для `README.md`, посвящённые **Этапам 3 и 4**:

---

### Этап 3. Основные операции

Реализовано построение графа зависимостей с использованием **итеративного DFS** (без рекурсии).  
Поддерживается:
- ограничение глубины анализа (`max_depth`);
- обнаружение и пропуск циклических зависимостей;
- два режима работы:  
  - `remote` — загрузка метаданных с npm-регистра через HTTP;  
  - `local` — чтение тестового репозитория из JSON-файла (пакеты обозначаются заглавными латинскими буквами, например `A@1.0`).

Пример запуска:  
```bash
python main.py config.toml
```

---

### Этап 4. Дополнительные операции

Добавлена функция вывода **обратных зависимостей**: для заданного пакета в формате `имя@версия` отображаются все пакеты из построенного графа, которые прямо или косвенно зависят от него.

Пример запуска:  
```bash
python main.py config.toml "D@1.0"
```

Функциональность протестирована на нескольких конфигурациях локального репозитория с циклами и разветвлёнными зависимостями.

**Астанин Георгий ИКБО-51-24**
